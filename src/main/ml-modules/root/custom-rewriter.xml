<!-- Copyright 2011-2018 MarkLogic Corporation.  All Rights Reserved. -->
<rewriter xmlns="http://marklogic.com/xdmp/rewriter">

    <match-path matches="^/datahub/kofax/document/([^/]+)/?$">
        <add-query-param name="name">$2</add-query-param>
        <match-method any-of="GET HEAD">
            <match-query-param name="txid">
                <set-transaction>$0</set-transaction>
                <set-transaction-mode>query</set-transaction-mode>
            </match-query-param>
            <dispatch>/documents/document-get.xqy</dispatch>
        </match-method>
        <match-method any-of="POST">
            <match-query-param name="txid">
                <set-transaction>$0</set-transaction>
                <set-transaction-mode>update</set-transaction-mode>
            </match-query-param>
            <dispatch>/documents/document-create.xqy</dispatch>
        </match-method>
    </match-path>

</rewriter>
